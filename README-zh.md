# CVE-2022-1329-WordPress-Elementor-RCE

该POC主要是基于[AkuCyberSec]((https://github.com/AkuCyberSec/CVE-2022-1329-WordPress-Elementor-3.6.0-3.6.1-3.6.2-Remote-Code-Execution-Exploit))的研究版本，并进行了一些补充。

# 使用说明

使用`docker-compose`开启漏洞环境：

```shell
docker-compose up -d
```

然后可以在浏览器访问WordPress的管理页面`http://localhost:8000/wp-admin`，可以使用的用户有2个：


| 用户名 | 密码   | 角色   |
|--------|--------|--------|
| wc     | 123456 | Admin  |
| a2     | aaaaaa | Editor |

使用admin帐号登录，可以看到在插件目录下，有`Elementor 3.6.1`，这个是受漏洞影响的版本。

然后可以使用POC脚本进行漏洞验证：

```shell
python3 poc.py
```

**注意：**脚本的运行结果可能返回`upload problem`，但其实脚本运行是成功的，可以刷新浏览器，看到恶意代码的执行结果。

目前植入的恶意脚本只有`phpinfo();`一句话，可以使用以下步骤进行编辑，**不过在重新运行漏洞脚本之前，需要到docker容器里面手动删除已安装的elementor-pro插件**，路径应该是`/var/www/html/wp-content/plugin/elementor-pro`。

```shell
# 解开压缩包
unzip elementor-pro.zip

# 修改植入代码，目前放在了文件的最上边
nano elementor-pro/elementor-pro.php

# 重新打包
rm elementor-pro.zip; zip -ry elementor-pro.zip elementor-pro

# 运行漏洞验证
python3 poc.py
```
